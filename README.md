# –°—Ç–µ–∫ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É Grafana –¥–ª—è –¥–µ–º–æ-–∑–∞—Å—Ç–æ—Å—É–Ω–∫—É —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é docker-compose

## –°–µ—Ä–µ–¥–æ–≤–∏—â–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è
- VDS –∑ [Ubuntu 22.04.3](https://ubuntu.com/) LTS (GNU/Linux 5.15.0-91-generic x86_64) —Ç–∞ –¥–æ–º–µ–Ω–Ω–∏–º —ñ–º'—è–º [http://smart-home.dp.ua/](http://smart-home.dp.ua:3002/d/KhuTkQcSk/world-time-bot?orgId=1)  
- [–¢–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç](https://t.me/umanetsvitalii_bot) üåç time_bot
- [Docker Compose](https://docs.docker.com/compose/)

## –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–¥—É, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–æ–¥—É –±–æ—Ç–∞ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É Grafana

–í–µ—Å—å –ø—Ä–æ—Ü–µ—Å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—ñ–∑–∞—Ü—ñ—ó –∫–æ–¥–∞ —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞ –æ–ø–∏—Å–∞–Ω–∏–π –≤ –ª–µ–∫—Ü—ñ–π–Ω–æ–º—É –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ [–∑–∞ —Ü–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º](https://github.com/vit-um/DevOps/wiki/%D0%9C%D0%BE%D0%BD%D1%96%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3#coding-session-k8s--otel)

## –ü—Ä–æ—Ü–µ—Å —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

1. –ö–ª–æ–Ω—É—î–º–æ —Ü–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ 
```sh
git clone -b opentelemetry https://github.com/vit-um/kbot
cd kbot
```
2. –ì–æ—Ç—É—î–º–æ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –∑ —Ç–æ–∫–µ–Ω–æ–º: 
```sh
sudo -s
export TELE_TOKEN={token}
env
```

3. –†–æ–∑–≥–æ—Ä—Ç–∞—î–º–æ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Ç–∞ –æ–ø–∏—Å–∞–Ω—ñ –≤ `docker-compose.yaml`:
```sh
git pull
docker-compose -f otel/docker-compose.yaml up
```
4. –í–ø–µ–≤–Ω–∏–º–æ—Å—å, —â–æ –≤—Å–µ –ø—ñ–¥–Ω—è–ª–æ—Å—å:
```sh 
ubuntu-serv# docker ps -a

CONTAINER ID   IMAGE                                            COMMAND                  CREATED        STATUS        PORTS                                                        NAMES
e898dd49a3b0   umanetsvitaliy/kbot:v1.5.0-8d0aaa8-linux-amd64   "./kbot go"              30 hours ago   Up 30 hours                                                                otel-kbot-1
ec7ae74269ee   grafana/loki:2.8.2                               "/usr/bin/loki -conf‚Ä¶"   30 hours ago   Up 30 hours   0.0.0.0:3100->3100/tcp, :::3100->3100/tcp                    otel-loki-1
5008a49941d6   grafana/grafana:9.4.3                            "/run.sh"                30 hours ago   Up 30 hours   3000/tcp, 0.0.0.0:3002->3002/tcp, :::3002->3002/tcp          otel-grafana-1
0580e35886fd   prom/prometheus:latest                           "/bin/prometheus --c‚Ä¶"   30 hours ago   Up 30 hours   0.0.0.0:9090->9090/tcp, :::9090->9090/tcp                    otel-prometheus-1
f53db7f2aa4a   otel/opentelemetry-collector-contrib:0.78.0      "/otelcol-contrib --‚Ä¶"   30 hours ago   Up 30 hours   0.0.0.0:4317->4317/tcp, :::4317->4317/tcp, 55678-55679/tcp   otel-collector-1
db4a6fb3bc49   fluent/fluent-bit:latest                         "/fluent-bit/bin/flu‚Ä¶"   30 hours ago   Up 30 hours   2020/tcp, 0.0.0.0:3001->3001/tcp, :::3001->3001/tcp          otel-fluentbit-1
```

5. –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–∏—Å—Ç–µ–º–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É

![Grafana Dashboard](.img/GrafanaDashboard.png) 

## –°—Ç–µ–∫ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É Grafana —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ñ Kubernetes 

**–ó–∞–≤–¥–∞–Ω–Ω—è:**   
–°—Ç–µ–∫ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ —Ç–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ —É dev-—Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ –≤ Kubernetes –¥–ª—è –≤–ª–∞—Å–Ω–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Flux. Otel —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º. Fluentbit –∑–±–∏—Ä–∞—î —Ç–∞ –µ–∫—Å–ø–æ—Ä—Ç—É—î –ª–æ–≥–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ —É—Å—ñ—Ö –Ω–æ–¥ –∫–ª–∞—Å—Ç–µ—Ä—É. –ü—Ä–æ—î–∫—Ç —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤–∞–Ω–æ –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É –º–µ—Ç—Ä–∏–∫.

–°–ø—Ä–æ–±–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ –±–∞–∑—ñ –¥–æ—Å—è–≥–Ω–µ–Ω—å —à–∞–Ω–æ–≤–Ω–æ–≥–æ [Andygol](https://github.com/Andygol) –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ –≥—ñ–ª—Ü—ñ `otel`—Ü—å–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é.